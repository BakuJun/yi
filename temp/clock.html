<!DOCTYPE html>
<html>

<head>
  <title>24-Hour Clock with Earthly Branches</title>
  <style>
    #clockCanvas {
      display: block;
      margin: 0 auto;
      border: 1px solid black;
    }

    #timeContainer {
      text-align: center;
      margin-top: 10px;
      font-size: 20px;
    }
  </style>
</head>

<body>
  <canvas id="clockCanvas" width="400" height="400"></canvas>
  <div id="timeContainer">
    <div id="currentTime"></div>
    <div id="earthlyBranch"></div>
  </div>

  <script>
    const canvas = document.getElementById('clockCanvas');
    const context = canvas.getContext('2d');
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const radius = canvas.width * 0.4;
    // 地支对应的时间段定义
    const earthlyBranches = [
      { name: '子', times: [23, 0] },
      { name: '丑', times: [1, 2] },
      { name: '寅', times: [3, 4] },
      { name: '卯', times: [5, 6] },
      { name: '辰', times: [7, 8] },
      { name: '巳', times: [9, 10] },
      { name: '午', times: [11, 12] },
      { name: '未', times: [13, 14] },
      { name: '申', times: [15, 16] },
      { name: '酉', times: [17, 18] },
      { name: '戌', times: [19, 20] },
      { name: '亥', times: [21, 22] }
    ];


    function drawClock() {
      context.clearRect(0, 0, canvas.width, canvas.height);

      drawClockFace();
      drawHourMarkers();
      drawEarthlyBranches();
      drawClockHands();
      updateDisplay();
    }

    function drawClockFace() {
      context.beginPath();
      context.arc(centerX, centerY, radius, 0, 2 * Math.PI);
      context.strokeStyle = 'black';
      context.lineWidth = 4;
      context.stroke();
    }

    function drawHourMarkers() {
      for (let i = 0; i < 24; i++) {
        const angle = (2 * Math.PI * i) / 24;
        const x1 = centerX + radius * Math.cos(angle - Math.PI / 2);
        const y1 = centerY + radius * Math.sin(angle - Math.PI / 2);
        const x2 = centerX + (radius + 20) * Math.cos(angle - Math.PI / 2);
        const y2 = centerY + (radius + 20) * Math.sin(angle - Math.PI / 2);

        context.font = '14px Arial';
        context.fillStyle = 'black';
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.fillText(i.toString(), x2, y2);

        context.beginPath();
        if (i % 2 == 0) {
          context.arc(x1, y1, 4, 0, 4 * Math.PI)
          context.fillStyle = '#484848'; // 
        } else {
          context.arc(x1, y1, 8, 0, 8 * Math.PI)
          context.fillStyle = '#F75D59'; // 
        }

        context.fill();
      }
    }

    function drawEarthlyBranches() {
      for (let i = 0; i < 12; i++) {
        const angle = (2 * Math.PI * i) / 12;
        const x = centerX + (radius - 20) * Math.cos(angle - Math.PI / 2);
        const y = centerY + (radius - 20) * Math.sin(angle - Math.PI / 2);
        context.font = '22px Arial';
        context.fillStyle = '#5C82C1'; // Sky Blue
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.fillText(earthlyBranches[i].name, x, y);
      }
    }

    function drawClockHands() {
      const now = new Date();
      const hours = now.getHours() % 24;
      const minutes = now.getMinutes();
      const seconds = now.getSeconds();

      drawClockHand(
        centerX,
        centerY,
        (2 * Math.PI * (hours + minutes / 60)) / 24,
        radius * 0.5,
        'blue',
        8
      );

      drawClockHand(
        centerX,
        centerY,
        (2 * Math.PI * (minutes + seconds / 60)) / 60,
        radius * 0.7,
        'green',
        6
      );

      drawClockHand(
        centerX,
        centerY,
        (2 * Math.PI * seconds) / 60,
        radius * 0.8,
        'red',
        2
      );
    }

    function drawClockHand(x, y, angle, length, color, lineWidth) {
      const handX = x + length * Math.cos(angle - Math.PI / 2);
      const handY = y + length * Math.sin(angle - Math.PI / 2);
      context.beginPath();
      context.moveTo(x, y);
      context.lineTo(handX, handY);
      context.strokeStyle = color;
      context.lineWidth = lineWidth;
      context.stroke();
    }

    function updateDisplay() {
      const now = new Date();
      const hours = now.getHours() % 24;
      const minutes = now.getMinutes();
      const seconds = now.getSeconds();

      let currentEarthlyBranchIndex;

      // 查找当前时间所在的地支
      for (let i = 0; i < earthlyBranches.length; i++) {
        const times = earthlyBranches[i].times;
        const startHour = times[0];
        const endHour = times[1];

        if ((hours >= startHour && hours <= endHour) || (startHour > endHour && (hours >= startHour || hours <= endHour))) {
          currentEarthlyBranchIndex = i;
          break;
        }
      }

      const currentEarthlyBranch = earthlyBranches[currentEarthlyBranchIndex].name;

      // 更新页面中的时间和地支显示
      document.getElementById('currentTime').textContent = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
      document.getElementById('earthlyBranch').textContent = `属${currentEarthlyBranch}时`;
    }

    setInterval(drawClock, 1000);
    setInterval(updateDisplay, 1000); // Update time and Earthly Branch
    drawClock();
  </script>
</body>

</html>